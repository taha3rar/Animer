<div class="row">
  <div class="col-md-6">
    <div class="info">
      <p class="heading-3">ISSUED BY</p>
      <app-user-data [user]="seller" [issued_by]="true"></app-user-data>
    </div>
  </div>
  <div class="col-md-6">
    <div class="info">
      <p class="heading-3">ISSUED FOR</p>
      <app-user-data [user]="buyer" [issued_for]="true"></app-user-data>
    </div>
  </div>
</div>
<div class="row">
  <div class="col">
    <table class="table-blue">
      <thead>
        <tr>
          <th>PRODUCT</th>
          <th>DESCRIPTION</th>
          <th>SPECIFICATIONS</th>
          <th>AMOUNT REQUESTED</th>
          <th>AMOUNT OFFERED</th>
          <th>RATE</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="product">
          <td>
            <span *ngIf="!product.product_type || product.product_type == 'agricultural'">
              {{ product.produce }} / {{ product.variety }}
            </span>
            <span *ngIf="product.product_type == 'processed' && product.item_package_type">
              {{ product.produce }} / {{ product.item_measurement_amount | number: '1.2-2' }}
              {{ product.item_measurement_unit | uppercase }} / {{ product.item_package_type }}
            </span>
            <span *ngIf="product.product_type == 'processed' && !product.item_package_type">
              {{ product.produce }}
            </span>
            <span *ngIf="product.product_type == 'input'"
              >{{ product.produce }} / <span *ngIf="product.other_input_type">{{ product.other_input_type }}</span>
              <span *ngIf="!product.other_input_type">{{ product.input_produce_type }}</span>
            </span>
          </td>
          <td>
            <span *ngIf="!product.product_type || product.product_type == 'agricultural'">
              {{ product.package_weight | number: '1.2-2' }} per package ({{ product.type_of_package }})
            </span>
            <span *ngIf="product.product_type == 'processed' && product.item_package_type">
              {{ product.items_per_package | number: '1.0' }}
              <span *ngIf="product.items_per_package > 1"> units</span>
              <span *ngIf="product.items_per_package == 0"> unit</span>
              per package ({{ product.type_of_package }})
            </span>
            <span *ngIf="product.product_type == 'processed' && !product.item_package_type">
              {{ product.quantity_offered || 0 | number: '1.0' }} ({{ product.type_of_package }})
            </span>
            <span *ngIf="product.product_type == 'input'">
              <span *ngIf="product.item_description">{{ product.item_description }}</span>
              <span *ngIf="!product.item_description">
                {{ product.item_measurement_amount }} {{ product.weight_unit }} per unit
              </span>
            </span>
          </td>
          <td>
            <span id="specification">{{ product.specification || 'N/A' }}</span>
          </td>
          <td>
            <span *ngIf="quoteRequest.product.product_type == 'agricultural'"
              >{{ quoteRequest.product.total_weight_requested | number: '1.2-2' }}
              {{ quoteRequest.product.weight_unit }}({{ quoteRequest.product.quantity_requested }}
              <span *ngIf="quoteRequest.product.quantity_requested > 1">packages</span>
              <span *ngIf="quoteRequest.product.quantity_requested == 1">package</span>
              <small> Estimated</small>)
            </span>
            <span *ngIf="quoteRequest.product.product_type == 'processed'"
              >{{ quoteRequest.product.quantity_requested }} packages ({{ quoteRequest.product.total_amount_items }}
              <span *ngIf="quoteRequest.product.total_amount_items > 1">units</span>
              <span *ngIf="quoteRequest.product.total_amount_items == 1">unit</span>)</span
            >
            <span *ngIf="quoteRequest.product.product_type == 'input'">
              {{ quoteRequest.product.quantity_requested }}
              <span *ngIf="product.quantity_requested > 1">units</span>
              <span *ngIf="product.quantity_requested == 1">unit</span>
            </span>
          </td>
          <td>
            <span *ngIf="quoteRequest.product.product_type == 'agricultural'">
              <label for="total_weight_offered">Offered amount (in {{ product.weight_unit }})</label>
              <input
                id="total_weight_offered"
                [(ngModel)]="product.total_weight_offered"
                min="0"
                [max]="product.total_weight_requested"
                type="number"
                class="form-control"
                (ngModelChange)="setProductSubtotal()"
                placeholder="Add weight here"
              />
            </span>
            <span *ngIf="quoteRequest.product.product_type != 'agricultural'">
              <label for="quantity_offered"
                >Offered amount
                <span *ngIf="quoteRequest.product.product_type == 'processed'">({{ product.type_of_package }})</span>
                <span *ngIf="quoteRequest.product.product_type == 'input'">(Unit)</span>
              </label>
              <input
                id="quantity_offered"
                [(ngModel)]="product.quantity_offered"
                min="0"
                [max]="product.quantity_requested"
                type="number"
                class="form-control"
                (ngModelChange)="setProductSubtotal(); setUnitsNumber()"
                placeholder="Add quantity here"
              />
            </span>
          </td>
          <td>
            <label for="price"
              >Price per {{ product.weight_unit || product.type_of_package }} (in {{ quotation?.currency }})</label
            >
            <input
              *ngIf="product.product_type != 'processed'"
              id="price"
              min="0"
              type="number"
              class="form-control"
              [(ngModel)]="product.price_per_unit"
              (ngModelChange)="setProductSubtotal()"
              placeholder="Add price here"
            />
            <input
              *ngIf="product.product_type == 'processed'"
              id="price"
              min="0"
              type="number"
              class="form-control"
              [(ngModel)]="product.package_price"
              (ngModelChange)="setProductSubtotal()"
              placeholder="Add price here"
            />
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <form [formGroup]="quotationForm">
      <div class="info">
        <p class="heading-3 mb-3">COMMENTS</p>
        <textarea
          class="form-control"
          name="comments"
          id="comments"
          formControlName="seller_comments"
          rows="5"
          placeholder="Type your comments here..."
        ></textarea>
      </div>
    </form>
  </div>
  <div class="col-md-2 col-md-offset-4">
    <div class="subtotal-price pull-right">
      <p class="heading-2">SUBTOTAL</p>
      <p class="heading-2 t-blue">
        {{ quotationForm.value.total_price || 0.0 | number: '1.2-2' }} {{ quotation.currency }}
      </p>
    </div>
  </div>
</div>
<button [hidden]="!quotationForm.valid" class="bttn-primary pull right next-step">
  Next Step &rarr;
</button>
<button [hidden]="quotationForm.valid" class="bttn-primary pull right">
  Next Step &rarr;
</button>
