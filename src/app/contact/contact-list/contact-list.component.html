<a class="pull-right need-help" data-toggle="wizard" data-target="#contactTutorials">Need help?</a>
<h1 class="main-title">Contacts</h1>
<div class="helper-panel">
  <i class="material-icons pull-left">info</i>
  <p *ngIf="isInvited">Review your work with the Contact who invited you to his network.</p>
  <p *ngIf="!isInvited">
    Invite new Contacts to your network, centrally manage your existing contacts, and review the transactions you have
    with them.
  </p>
</div>
<h1 class="main-title" *ngIf="hasContacts">Contact List</h1>

<div class="mt-1 actions-section clearfix" *ngIf="hasContacts">
  <div class="searchbar d-flex">
    <input [(ngModel)]="searchTerm" placeholder="Search contacts..." class="search-bar" type="search" />
    <span class="pt-3 pl-4"></span>
  </div>
  <div class="flex-pr">
    <button
      (click)="addContact()"
      class="bttn-primary bttn-add"
      data-toggle="wizard"
      *ngxPermissionsOnly="['create-client']"
      data-target="#addContactWizard"
      matTooltip="{{ tooltips.add_contact }}"
      matTooltipPosition="above"
    >
      <span class="btn-desktop-txt">Add a Contact</span>
      <span class="btn-mobile-txt">Add</span>
    </button>
  </div>
</div>

<table class="table main-table" matSort (matSortChange)="sortData($event)" *ngIf="hasContacts">
  <thead>
    <tr id="table-head">
      <th mat-sort-header="id">ID</th>
      <th mat-sort-header="contact" class="text-center">Contact</th>
      <th mat-sort-header="details" class="text-center">Details</th>
      <th mat-sort-header="country" class="text-center">Country</th>
      <th class="text-right">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr
      *ngFor="
        let contact of contacts
          | filter: searchTerm
          | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage };
        let i = index
      "
    >
      <td>{{ contact.numericId }}</td>
      <td>
        <span *ngIf="contact.company_name">{{ contact.company_name }} / </span>{{ contact.first_name }}
        {{ contact.last_name }}
      </td>
      <td>
        <span *ngIf="contact.email && contact.phone_number">{{ contact.email }} / {{ contact.phone_number }}</span>
        <span *ngIf="contact.email && !contact.phone_number">{{ contact.email }}</span>
        <span *ngIf="!contact.email && contact.phone_number">{{ contact.phone_number }}</span>
      </td>
      <td>
        {{ contact.country }}
        <span *ngIf="!contact.country">N/A</span>
      </td>
      <td>
        <a id="view" [routerLink]="['/contact', contact._id]">View</a>
        <a (click)="editContact(i)" data-toggle="wizard" data-target="#addContactWizard" id="edit">Edit</a>
      </td>
    </tr>
  </tbody>
</table>
<div style="background-color: white;">
  <div class="add-supplier-box panel" *ngIf="!hasContacts">
    <div class="panel-body">
      <img src="../../../assets/img/default/pi-po/noClient.png" width="375" height="225" />
      <p style="font-size: large;">Add your first contact and begin trading.</p>
      <button
        class="bttn-primary bttn-add"
        data-toggle="wizard"
        *ngxPermissionsOnly="['create-client']"
        data-target="#addContactWizard"
        matTooltip="{{ tooltips.add_contact }}"
        matTooltipPosition="below"
      >
        <span>Add your first Contact</span>
      </button>
    </div>
  </div>
</div>

<div class="mobile-list-wrapper">
  <div
    class="strip mt-4 mb-3"
    *ngFor="
      let contact of contacts | filter: searchTerm | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage };
      let i = index
    "
  >
    <div># {{ contact.numericId }}</div>
    <div>
      <span *ngIf="contact.company_name">{{ contact.company_name }} / </span>{{ contact.first_name }}
      {{ contact.last_name }}
    </div>
    <div>
      <span *ngIf="contact.email && contact.phone_number">{{ contact.email }} / {{ contact.phone_number }}</span>
      <span *ngIf="contact.email && !contact.phone_number">{{ contact.email }}</span>
      <span *ngIf="!contact.email && contact.phone_number">{{ contact.phone_number }}</span>
    </div>
    <div>
      <div>
        {{ contact.country }}
        <span *ngIf="!contact.country">N/A</span>
      </div>
    </div>
    <div class="mt-3">
      <a id="view" [routerLink]="['/contact', contact._id]">View</a>
      <a (click)="editContact(i)" class="ml-4" data-toggle="wizard" data-target="#addContactWizard" id="edit">Edit</a>
    </div>
  </div>
</div>

<pagination-controls (pageChange)="pageChanged($event)" *ngIf="hasContacts"></pagination-controls>

<app-contact-generator [contact]="contact" [edit]="edit"></app-contact-generator>
<app-contact-tutorials></app-contact-tutorials>
