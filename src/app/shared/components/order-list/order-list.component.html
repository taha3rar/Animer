<table class="table main-table" matSort (matSortChange)="sortData($event)" *ngIf="hasOrders">
  <thead>
    <tr>
      <th mat-sort-header="id" translate class="text-center">ID</th>
      <th mat-sort-header="date" translate>Date</th>
      <th *ngIf="!viewAsSeller" mat-sort-header="company" translate>Issued for</th>
      <th *ngIf="viewAsSeller" mat-sort-header="company" translate>Issued by</th>
      <th translate>Product</th>
      <th mat-sort-header="amount" translate>Amount</th>
      <th mat-sort-header="price" translate>Price</th>
      <th mat-sort-header="status" translate>Status</th>
      <th translate class="text-right">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr
      *ngFor="
        let order of (orders | filter: searchTerm | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage })
      "
    >
      <td class="text-center">{{ order.numericId }}</td>
      <td>{{ order.date_created | date: 'dd/MM/yyyy' }}</td>
      <td>
        <span
          *ngIf="
            (userId == order.seller._id && !order.buyer.company_name) ||
            (userId == order.buyer._id && !order.seller.company_name)
          "
          >N/A</span
        >
        <span *ngIf="userId == order.seller._id"
          >{{ order.buyer.company_name }} / {{ order.buyer.first_name }} {{ order.buyer.last_name }}</span
        >
        <span *ngIf="userId == order.buyer._id"
          >{{ order.seller.company_name }} / {{ order.seller.first_name }} {{ order.seller.last_name }}</span
        >
      </td>
      <td>
        <span *ngIf="order.products.length > 1">
          Mutltiple products
        </span>
        <ng-container *ngIf="order.products.length === 1">
          <span *ngIf="order.products[0].product_type == 'agricultural'"
            >{{ order.products[0].produce }} / {{ order.products[0].variety }}</span
          >
          <span *ngIf="order.products[0].product_type == 'processed'">{{ order.products[0].produce }}</span>
          <span *ngIf="order.products[0].product_type == 'input'"
            >{{ order.products[0].produce }} /
            <span *ngIf="order.products[0].other_input_type">{{ order.products[0].other_input_type }}</span>
            <span *ngIf="!order.products[0].other_input_type">{{ order.products[0].input_produce_type }}</span>
          </span>
        </ng-container>
      </td>
      <td>
        <span *ngIf="order.total_weight && order.document_weight_unit"
          >{{ order.total_weight | number: '1.2-2' }}
          {{ order.document_weight_unit }}
          <span *ngIf="hasProcessedProduct(order)" style="font-size :11px;color:gray"
            >Excluding processed products</span
          ></span
        >
        <span *ngIf="order.total_weight && !order.document_weight_unit">
          <i
            class="material-icons pull-left"
            matTooltip="{{ measurementUnitConflictMessage }}"
            matTooltipClass="tooltip-table"
            >help_outline</i
          >
        </span>
        <span *ngIf="!order.total_weight && order.products.length > 0"
          ><i
            class="material-icons pull-left"
            matTooltip="{{ processedProductConflictMessage }}"
            matTooltipClass="tooltip-table"
            >help_outline</i
          ></span
        >
        <span *ngIf="order.products.length < 1">N/A</span>
      </td>
      <td>
        <span *ngIf="order.total_due">{{ totalDue(order) | number: '1.2-2' }} {{ order.currency }}</span>
        <span *ngIf="!order.total_due">N/A</span>
      </td>
      <td>
        <div *ngIf="order.status === 'INVOICE RECEIVED'" class="status status-green">{{ order.status }}</div>
        <div *ngIf="order.status === 'ORDER SENT'" class="status status-orange">{{ order.status }}</div>
        <div *ngIf="order.status === 'ORDER SAVED'" class="status status-yellow">{{ order.status }}</div>
        <div *ngIf="order.status === 'INVOICE SENT'" class="status status-green">{{ order.status }}</div>
        <div *ngIf="order.status === 'ORDER RECEIVED'" class="status status-orange">{{ order.status }}</div>
        <div *ngIf="order.status === 'PENDING PAYMENT'" class="status status-bg-orange">{{ order.status }}</div>
        <div *ngIf="order.status === 'PAYMENT PAID'" class="status status-bg-green">{{ order.status }}</div>
      </td>
      <td class="text-right">
        <button
          *ngIf="userId == order.buyer._id && !order.draft"
          data-toggle="stepper"
          class="round-button-primary"
          [routerLink]="['/order', order._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button
          *ngIf="userId == order.seller._id && !order.draft && order.invoice?._id && !order.invoice?.draft"
          data-toggle="stepper"
          class="round-button-primary"
          [routerLink]="['/order', order._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button
          *ngIf="(order.invoice || userId == order.buyer._id) && order.draft && !order.external_order"
          class="round-button-primary"
          data-toggle="stepper"
          [routerLink]="['/order/generator', order._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button
          *ngIf="(order.invoice || userId == order.buyer._id) && order.draft && order.external_order"
          class="round-button-primary"
          data-toggle="stepper"
          [routerLink]="['/order/generator/open', order._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button
          *ngIf="userId == order.seller._id && !order.invoice"
          class="round-button-primary"
          data-toggle="stepper"
          [routerLink]="['/order/invoice/generator', order._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button
          *ngIf="userId == order.seller._id && order.invoice?.draft"
          class="round-button-primary"
          data-toggle="stepper"
          [routerLink]="['/order/invoice/generator/draft', order.invoice._id]"
        >
          <i class="material-icons">remove_red_eye</i>
        </button>
        <button *ngIf="canDelete" class="round-button-red" (click)="warning(order._id)">
          <i class="material-icons">delete</i>
        </button>
      </td>
    </tr>
  </tbody>
</table>
<div style="background-color: white;" *ngxPermissionsOnly="['create-order']">
  <div class="add-supplier-box panel" *ngIf="!hasOrders">
    <div class="panel-body">
      <img src="../../../assets/img/dashboard-imgs/orders.png" height="200" width="310" />
      <p style="font-size: large;">Start trading digitally by creating your first Purchase Order.</p>
      <div class="dropdown">
        <button
          class="bttn-primary dropdown-toggle"
          matTooltip="{{ tooltips.place_order }}"
          data-toggle="dropdown"
          matTooltipPosition="above"
        >
          <span translate>Place Order </span>
        </button>
        <ul class="dropdown-menu">
          <li routerLink="/order/generator/standard" matTooltip="{{ tooltips.internal_po }}" matTooltipPosition="left">
            <a>Internal Purchase Order</a>
          </li>
          <li routerLink="/order/generator/open" matTooltip="{{ tooltips.external_po }}" matTooltipPosition="left">
            <a>External Purchase Order</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<pagination-controls (pageChange)="pageChanged($event)" *ngIf="hasOrders"></pagination-controls>
